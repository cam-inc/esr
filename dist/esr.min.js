var esr=function(){"use strict";var e="0.9.3";var n=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"};var t=_;var r=u;var i=s;var o=v;var a=b;var f=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function u(e,n){var t=[];var r=0;var i=0;var o="";var a=n&&n.delimiter||"/";var u;while((u=f.exec(e))!=null){var s=u[0];var c=u[1];var l=u.index;o+=e.slice(i,l);i=l+s.length;if(c){o+=c[1];continue}var v=e[i];var p=u[2];var y=u[3];var g=u[4];var m=u[5];var w=u[6];var b=u[7];if(o){t.push(o);o=""}var _=p!=null&&v!=null&&v!==p;var O=w==="+"||w==="*";var x=w==="?"||w==="*";var E=u[2]||a;var A=g||m;t.push({name:y||r++,prefix:p||"",delimiter:E,optional:x,repeat:O,partial:_,asterisk:!!b,pattern:A?d(A):b?".*":"[^"+h(E)+"]+?"})}if(i<e.length){o+=e.substr(i)}if(o){t.push(o)}return t}function s(e,n){return v(u(e,n))}function c(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function l(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function v(e){var t=new Array(e.length);for(var r=0;r<e.length;r++){if(typeof e[r]==="object"){t[r]=new RegExp("^(?:"+e[r].pattern+")$")}}return function(r,i){var o="";var a=r||{};var f=i||{};var u=f.pretty?c:encodeURIComponent;for(var s=0;s<e.length;s++){var v=e[s];if(typeof v==="string"){o+=v;continue}var h=a[v.name];var d;if(h==null){if(v.optional){if(v.partial){o+=v.prefix}continue}else{throw new TypeError('Expected "'+v.name+'" to be defined')}}if(n(h)){if(!v.repeat){throw new TypeError('Expected "'+v.name+'" to not repeat, but received `'+JSON.stringify(h)+"`")}if(h.length===0){if(v.optional){continue}else{throw new TypeError('Expected "'+v.name+'" to not be empty')}}for(var p=0;p<h.length;p++){d=u(h[p]);if(!t[s].test(d)){throw new TypeError('Expected all "'+v.name+'" to match "'+v.pattern+'", but received `'+JSON.stringify(d)+"`")}o+=(p===0?v.prefix:v.delimiter)+d}continue}d=v.asterisk?l(h):u(h);if(!t[s].test(d)){throw new TypeError('Expected "'+v.name+'" to match "'+v.pattern+'", but received "'+d+'"')}o+=v.prefix+d}return o}}function h(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function d(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function p(e,n){e.keys=n;return e}function y(e){return e.sensitive?"":"i"}function g(e,n){var t=e.source.match(/\((?!\?)/g);if(t){for(var r=0;r<t.length;r++){n.push({name:r,prefix:null,delimiter:null,optional:false,repeat:false,partial:false,asterisk:false,pattern:null})}}return p(e,n)}function m(e,n,t){var r=[];for(var i=0;i<e.length;i++){r.push(_(e[i],n,t).source)}var o=new RegExp("(?:"+r.join("|")+")",y(t));return p(o,n)}function w(e,n,t){return b(u(e,t),n,t)}function b(e,t,r){if(!n(t)){r=t||r;t=[]}r=r||{};var i=r.strict;var o=r.end!==false;var a="";for(var f=0;f<e.length;f++){var u=e[f];if(typeof u==="string"){a+=h(u)}else{var s=h(u.prefix);var c="(?:"+u.pattern+")";t.push(u);if(u.repeat){c+="(?:"+s+c+")*"}if(u.optional){if(!u.partial){c="(?:"+s+"("+c+"))?"}else{c=s+"("+c+")?"}}else{c=s+"("+c+")"}a+=c}}var l=h(r.delimiter||"/");var v=a.slice(-l.length)===l;if(!i){a=(v?a.slice(0,-l.length):a)+"(?:"+l+"(?=$))?"}if(o){a+="$"}else{a+=i&&v?"":"(?="+l+"|$)"}return p(new RegExp("^"+a,y(r)),t)}function _(e,t,r){if(!n(t)){r=t||r;t=[]}r=r||{};if(e instanceof RegExp){return g(e,t)}if(n(e)){return m(e,t,r)}return w(e,t,r)}t.parse=r;t.compile=i;t.tokensToFunction=o;t.tokensToRegExp=a;var O=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function E(e,n){return n={exports:{}},e(n,n.exports),n.exports}var A=E(function(e){(function(n){var t=setTimeout;function r(){}function i(e,n){return function(){e.apply(n,arguments)}}function o(e){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof e!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];l(e,this)}function a(e,n){while(e._state===3){e=e._value}if(e._state===0){e._deferreds.push(n);return}e._handled=true;o._immediateFn(function(){var t=e._state===1?n.onFulfilled:n.onRejected;if(t===null){(e._state===1?f:u)(n.promise,e._value);return}var r;try{r=t(e._value)}catch(e){u(n.promise,e);return}f(n.promise,r)})}function f(e,n){try{if(n===e){throw new TypeError("A promise cannot be resolved with itself.")}if(n&&(typeof n==="object"||typeof n==="function")){var t=n.then;if(n instanceof o){e._state=3;e._value=n;s(e);return}else if(typeof t==="function"){l(i(t,n),e);return}}e._state=1;e._value=n;s(e)}catch(n){u(e,n)}}function u(e,n){e._state=2;e._value=n;s(e)}function s(e){if(e._state===2&&e._deferreds.length===0){o._immediateFn(function(){if(!e._handled){o._unhandledRejectionFn(e._value)}})}for(var n=0,t=e._deferreds.length;n<t;n++){a(e,e._deferreds[n])}e._deferreds=null}function c(e,n,t){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof n==="function"?n:null;this.promise=t}function l(e,n){var t=false;try{e(function(e){if(t){return}t=true;f(n,e)},function(e){if(t){return}t=true;u(n,e)})}catch(e){if(t){return}t=true;u(n,e)}}o.prototype["catch"]=function(e){return this.then(null,e)};o.prototype.then=function(e,n){var t=new this.constructor(r);a(this,new c(e,n,t));return t};o.all=function(e){var n=Array.prototype.slice.call(e);return new o(function(e,t){if(n.length===0){return e([])}var r=n.length;function i(o,a){try{if(a&&(typeof a==="object"||typeof a==="function")){var f=a.then;if(typeof f==="function"){f.call(a,function(e){i(o,e)},t);return}}n[o]=a;if(--r===0){e(n)}}catch(e){t(e)}}for(var o=0;o<n.length;o++){i(o,n[o])}})};o.resolve=function(e){if(e&&typeof e==="object"&&e.constructor===o){return e}return new o(function(n){n(e)})};o.reject=function(e){return new o(function(n,t){t(e)})};o.race=function(e){return new o(function(n,t){for(var r=0,i=e.length;r<i;r++){e[r].then(n,t)}})};o._immediateFn=typeof setImmediate==="function"&&function(e){setImmediate(e)}||function(e){t(e,0)};o._unhandledRejectionFn=function e(n){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",n)}};o._setImmediateFn=function e(n){o._immediateFn=n};o._setUnhandledRejectionFn=function e(n){o._unhandledRejectionFn=n};if(e.exports){e.exports=o}else if(!n.Promise){n.Promise=o}})(O)});var k=function(){};{k=function(e,n,t){var r=arguments;var i=arguments.length;t=new Array(i>2?i-2:0);for(var o=2;o<i;o++){t[o-2]=r[o]}if(n===undefined){throw new Error("`warning(condition, format, ...args)` requires a warning "+"message argument")}if(n.length<10||/^[s\W]*$/.test(n)){throw new Error("The warning format should be able to uniquely identify this "+"warning. Please, use a more descriptive format than: "+n)}if(!e){var a=0;var f="Warning: "+n.replace(/%s/g,function(){return t[a++]});if(typeof console!=="undefined"){console.error(f)}try{throw new Error(f)}catch(e){}}}}var P=k;var R=function(e,n,t,r,i,o,a,f){{if(n===undefined){throw new Error("invariant requires an error message argument")}}if(!e){var u;if(n===undefined){u=new Error("Minified exception occurred; use the non-minified dev environment "+"for the full error message and additional helpful warnings.")}else{var s=[t,r,i,o,a,f];var c=0;u=new Error(n.replace(/%s/g,function(){return s[c++]}));u.name="Invariant Violation"}u.framesToPop=1;throw u}};var S=R;var T=function e(n){return n.charAt(0)==="/"};var j=function e(n,t){for(var r=t,i=r+1,o=n.length;i<o;r+=1,i+=1){n[r]=n[i]}n.pop()};var B=function e(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var r=n&&n.split("/")||[];var i=t&&t.split("/")||[];var o=n&&T(n);var a=t&&T(t);var f=o||a;if(n&&T(n)){i=r}else if(r.length){i.pop();i=i.concat(r)}if(!i.length){return"/"}var u=void 0;if(i.length){var s=i[i.length-1];u=s==="."||s===".."||s===""}else{u=false}var c=0;for(var l=i.length;l>=0;l--){var v=i[l];if(v==="."){j(i,l)}else if(v===".."){j(i,l);c++}else if(c){j(i,l);c--}}if(!f){for(;c--;c){i.unshift("..")}}if(f&&i[0]!==""&&(!i[0]||!T(i[0]))){i.unshift("")}var h=i.join("/");if(u&&h.substr(-1)!=="/"){h+="/"}return h};var L=B;var H=E(function(e,n){n.__esModule=true;var t=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r=function e(n,r){if(n===r){return true}if(n==null||r==null){return false}if(Array.isArray(n)){return Array.isArray(r)&&n.length===r.length&&n.every(function(n,t){return e(n,r[t])})}var i=typeof n==="undefined"?"undefined":t(n);var o=typeof r==="undefined"?"undefined":t(r);if(i!==o){return false}if(i==="object"){var a=n.valueOf();var f=r.valueOf();if(a!==n||f!==r){return e(a,f)}var u=Object.keys(n);var s=Object.keys(r);if(u.length!==s.length){return false}return u.every(function(t){return e(n[t],r[t])})}return false};n.default=r});var M=x(H);var C=function e(n){return n.charAt(0)==="/"?n:"/"+n};var U=function e(n){return n.charAt(0)==="/"?n.substr(1):n};var F=function e(n,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(n)};var I=function e(n,t){return F(n,t)?n.substr(t.length):n};var Y=function e(n){return n.charAt(n.length-1)==="/"?n.slice(0,-1):n};var $=function e(n){var t=n||"/";var r="";var i="";var o=t.indexOf("#");if(o!==-1){i=t.substr(o);t=t.substr(0,o)}var a=t.indexOf("?");if(a!==-1){r=t.substr(a);t=t.substr(0,a)}return{pathname:t,search:r==="?"?"":r,hash:i==="#"?"":i}};var W=function e(n){var t=n.pathname,r=n.search,i=n.hash;var o=t||"/";if(r&&r!=="?"){o+=r.charAt(0)==="?"?r:"?"+r}if(i&&i!=="#"){o+=i.charAt(0)==="#"?i:"#"+i}return o};var q=Object.assign||function(e){var n=arguments;for(var t=1;t<arguments.length;t++){var r=n[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};var D=function e(n,t,r,i){var o=void 0;if(typeof n==="string"){o=$(n);o.state=t}else{o=q({},n);if(o.pathname===undefined){o.pathname=""}if(o.search){if(o.search.charAt(0)!=="?"){o.search="?"+o.search}}else{o.search=""}if(o.hash){if(o.hash.charAt(0)!=="#"){o.hash="#"+o.hash}}else{o.hash=""}if(t!==undefined&&o.state===undefined){o.state=t}}try{o.pathname=decodeURI(o.pathname)}catch(e){if(e instanceof URIError){throw new URIError('Pathname "'+o.pathname+'" could not be decoded. '+"This is likely caused by an invalid percent-encoding.")}else{throw e}}if(r){o.key=r}if(i){if(!o.pathname){o.pathname=i.pathname}else if(o.pathname.charAt(0)!=="/"){o.pathname=L(o.pathname,i.pathname)}}else{if(!o.pathname){o.pathname="/"}}return o};var J=function e(n,t){return n.pathname===t.pathname&&n.search===t.search&&n.hash===t.hash&&n.key===t.key&&M(n.state,t.state)};var N=function e(){var n=null;var t=function e(t){P(n==null,"A history supports only one prompt at a time");n=t;return function(){if(n===t){n=null}}};var r=function e(t,r,i,o){if(n!=null){var a=typeof n==="function"?n(t,r):n;if(typeof a==="string"){if(typeof i==="function"){i(a,o)}else{P(false,"A history needs a getUserConfirmation function in order to use a prompt message");o(true)}}else{o(a!==false)}}else{o(true)}};var i=[];var o=function e(n){var t=true;var r=function e(){if(t){n.apply(undefined,arguments)}};i.push(r);return function(){t=false;i=i.filter(function(e){return e!==r})}};var a=function e(){var n=arguments;for(var t=arguments.length,r=Array(t),o=0;o<t;o++){r[o]=n[o]}i.forEach(function(e){return e.apply(undefined,r)})};return{setPrompt:t,confirmTransitionTo:r,appendListener:o,notifyListeners:a}};var G=!!(typeof window!=="undefined"&&window.document&&window.document.createElement);var V=function e(n,t,r){return n.addEventListener?n.addEventListener(t,r,false):n.attachEvent("on"+t,r)};var z=function e(n,t,r){return n.removeEventListener?n.removeEventListener(t,r,false):n.detachEvent("on"+t,r)};var K=function e(n,t){return t(window.confirm(n))};var Q=function e(){var n=window.navigator.userAgent;if((n.indexOf("Android 2.")!==-1||n.indexOf("Android 4.0")!==-1)&&n.indexOf("Mobile Safari")!==-1&&n.indexOf("Chrome")===-1&&n.indexOf("Windows Phone")===-1){return false}return window.history&&"pushState"in window.history};var X=function e(){return window.navigator.userAgent.indexOf("Trident")===-1};var Z=function e(){return window.navigator.userAgent.indexOf("Firefox")===-1};var ee=function e(n){return n.state===undefined&&navigator.userAgent.indexOf("CriOS")===-1};var ne=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var te=Object.assign||function(e){var n=arguments;for(var t=1;t<arguments.length;t++){var r=n[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};var re="popstate";var ie="hashchange";var oe=function e(){try{return window.history.state||{}}catch(e){return{}}};var ae=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};S(G,"Browser history needs a DOM");var t=window.history;var r=Q();var i=!X();var o=n.forceRefresh,a=o===undefined?false:o,f=n.getUserConfirmation,u=f===undefined?K:f,s=n.keyLength,c=s===undefined?6:s;var l=n.basename?Y(C(n.basename)):"";var v=function e(n){var t=n||{},r=t.key,i=t.state;var o=window.location,a=o.pathname,f=o.search,u=o.hash;var s=a+f+u;P(!l||F(s,l),"You are attempting to use a basename on a page whose URL path does not begin "+'with the basename. Expected path "'+s+'" to begin with "'+l+'".');if(l){s=I(s,l)}return D(s,i,r)};var h=function e(){return Math.random().toString(36).substr(2,c)};var d=N();var p=function e(n){te(U,n);U.length=t.length;d.notifyListeners(U.location,U.action)};var y=function e(n){if(ee(n)){return}w(v(n.state))};var g=function e(){w(v(oe()))};var m=false;var w=function e(n){if(m){m=false;p()}else{var t="POP";d.confirmTransitionTo(n,t,u,function(e){if(e){p({action:t,location:n})}else{b(n)}})}};var b=function e(n){var t=U.location;var r=O.indexOf(t.key);if(r===-1){r=0}var i=O.indexOf(n.key);if(i===-1){i=0}var o=r-i;if(o){m=true;k(o)}};var _=v(oe());var O=[_.key];var x=function e(n){return l+W(n)};var E=function e(n,i){P(!((typeof n==="undefined"?"undefined":ne(n))==="object"&&n.state!==undefined&&i!==undefined),"You should avoid providing a 2nd state argument to push when the 1st "+"argument is a location-like object that already has state; it is ignored");var o="PUSH";var f=D(n,i,h(),U.location);d.confirmTransitionTo(f,o,u,function(e){if(!e){return}var n=x(f);var i=f.key,u=f.state;if(r){t.pushState({key:i,state:u},null,n);if(a){window.location.href=n}else{var s=O.indexOf(U.location.key);var c=O.slice(0,s===-1?0:s+1);c.push(f.key);O=c;p({action:o,location:f})}}else{P(u===undefined,"Browser history cannot push state in browsers that do not support HTML5 history");window.location.href=n}})};var A=function e(n,i){P(!((typeof n==="undefined"?"undefined":ne(n))==="object"&&n.state!==undefined&&i!==undefined),"You should avoid providing a 2nd state argument to replace when the 1st "+"argument is a location-like object that already has state; it is ignored");var o="REPLACE";var f=D(n,i,h(),U.location);d.confirmTransitionTo(f,o,u,function(e){if(!e){return}var n=x(f);var i=f.key,u=f.state;if(r){t.replaceState({key:i,state:u},null,n);if(a){window.location.replace(n)}else{var s=O.indexOf(U.location.key);if(s!==-1){O[s]=f.key}p({action:o,location:f})}}else{P(u===undefined,"Browser history cannot replace state in browsers that do not support HTML5 history");window.location.replace(n)}})};var k=function e(n){t.go(n)};var R=function e(){return k(-1)};var T=function e(){return k(1)};var j=0;var B=function e(n){j+=n;if(j===1){V(window,re,y);if(i){V(window,ie,g)}}else if(j===0){z(window,re,y);if(i){z(window,ie,g)}}};var L=false;var H=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var t=d.setPrompt(n);if(!L){B(1);L=true}return function(){if(L){L=false;B(-1)}return t()}};var M=function e(n){var t=d.appendListener(n);B(1);return function(){B(-1);t()}};var U={length:t.length,action:"POP",location:_,createHref:x,push:E,replace:A,go:k,goBack:R,goForward:T,block:H,listen:M};return U};var fe=Object.assign||function(e){var n=arguments;for(var t=1;t<arguments.length;t++){var r=n[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};var ue="hashchange";var se={hashbang:{encodePath:function e(n){return n.charAt(0)==="!"?n:"!/"+U(n)},decodePath:function e(n){return n.charAt(0)==="!"?n.substr(1):n}},noslash:{encodePath:U,decodePath:C},slash:{encodePath:C,decodePath:C}};var ce=function e(){var n=window.location.href;var t=n.indexOf("#");return t===-1?"":n.substring(t+1)};var le=function e(n){return window.location.hash=n};var ve=function e(n){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,t>=0?t:0)+"#"+n)};var he=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};S(G,"Hash history needs a DOM");var t=window.history;var r=Z();var i=n.getUserConfirmation,o=i===undefined?K:i,a=n.hashType,f=a===undefined?"slash":a;var u=n.basename?Y(C(n.basename)):"";var s=se[f],c=s.encodePath,l=s.decodePath;var v=function e(){var n=l(ce());P(!u||F(n,u),"You are attempting to use a basename on a page whose URL path does not begin "+'with the basename. Expected path "'+n+'" to begin with "'+u+'".');if(u){n=I(n,u)}return D(n)};var h=N();var d=function e(n){fe($,n);$.length=t.length;h.notifyListeners($.location,$.action)};var p=false;var y=null;var g=function e(){var n=ce();var t=c(n);if(n!==t){ve(t)}else{var r=v();var i=$.location;if(!p&&J(i,r)){return}if(y===W(r)){return}y=null;m(r)}};var m=function e(n){if(p){p=false;d()}else{var t="POP";h.confirmTransitionTo(n,t,o,function(e){if(e){d({action:t,location:n})}else{w(n)}})}};var w=function e(n){var t=$.location;var r=x.lastIndexOf(W(t));if(r===-1){r=0}var i=x.lastIndexOf(W(n));if(i===-1){i=0}var o=r-i;if(o){p=true;R(o)}};var b=ce();var _=c(b);if(b!==_){ve(_)}var O=v();var x=[W(O)];var E=function e(n){return"#"+c(u+W(n))};var A=function e(n,t){P(t===undefined,"Hash history cannot push state; it is ignored");var r="PUSH";var i=D(n,undefined,undefined,$.location);h.confirmTransitionTo(i,r,o,function(e){if(!e){return}var n=W(i);var t=c(u+n);var o=ce()!==t;if(o){y=n;le(t);var a=x.lastIndexOf(W($.location));var f=x.slice(0,a===-1?0:a+1);f.push(n);x=f;d({action:r,location:i})}else{P(false,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack");d()}})};var k=function e(n,t){P(t===undefined,"Hash history cannot replace state; it is ignored");var r="REPLACE";var i=D(n,undefined,undefined,$.location);h.confirmTransitionTo(i,r,o,function(e){if(!e){return}var n=W(i);var t=c(u+n);var o=ce()!==t;if(o){y=n;ve(t)}var a=x.indexOf(W($.location));if(a!==-1){x[a]=n}d({action:r,location:i})})};var R=function e(n){P(r,"Hash history go(n) causes a full page reload in this browser");t.go(n)};var T=function e(){return R(-1)};var j=function e(){return R(1)};var B=0;var L=function e(n){B+=n;if(B===1){V(window,ue,g)}else if(B===0){z(window,ue,g)}};var H=false;var M=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var t=h.setPrompt(n);if(!H){L(1);H=true}return function(){if(H){H=false;L(-1)}return t()}};var U=function e(n){var t=h.appendListener(n);L(1);return function(){L(-1);t()}};var $={length:t.length,action:"POP",location:O,createHref:E,push:A,replace:k,go:R,goBack:T,goForward:j,block:M,listen:U};return $};var de=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var pe=Object.assign||function(e){var n=arguments;for(var t=1;t<arguments.length;t++){var r=n[t];for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i)){e[i]=r[i]}}}return e};var ye=function e(n,t,r){return Math.min(Math.max(n,t),r)};var ge=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=n.getUserConfirmation,r=n.initialEntries,i=r===undefined?["/"]:r,o=n.initialIndex,a=o===undefined?0:o,f=n.keyLength,u=f===undefined?6:f;var s=N();var c=function e(n){pe(x,n);x.length=x.entries.length;s.notifyListeners(x.location,x.action)};var l=function e(){return Math.random().toString(36).substr(2,u)};var v=ye(a,0,i.length-1);var h=i.map(function(e){return typeof e==="string"?D(e,undefined,l()):D(e,undefined,e.key||l())});var d=W;var p=function e(n,r){P(!((typeof n==="undefined"?"undefined":de(n))==="object"&&n.state!==undefined&&r!==undefined),"You should avoid providing a 2nd state argument to push when the 1st "+"argument is a location-like object that already has state; it is ignored");var i="PUSH";var o=D(n,r,l(),x.location);s.confirmTransitionTo(o,i,t,function(e){if(!e){return}var n=x.index;var t=n+1;var r=x.entries.slice(0);if(r.length>t){r.splice(t,r.length-t,o)}else{r.push(o)}c({action:i,location:o,index:t,entries:r})})};var y=function e(n,r){P(!((typeof n==="undefined"?"undefined":de(n))==="object"&&n.state!==undefined&&r!==undefined),"You should avoid providing a 2nd state argument to replace when the 1st "+"argument is a location-like object that already has state; it is ignored");var i="REPLACE";var o=D(n,r,l(),x.location);s.confirmTransitionTo(o,i,t,function(e){if(!e){return}x.entries[x.index]=o;c({action:i,location:o})})};var g=function e(n){var r=ye(x.index+n,0,x.entries.length-1);var i="POP";var o=x.entries[r];s.confirmTransitionTo(o,i,t,function(e){if(e){c({action:i,location:o,index:r})}else{c()}})};var m=function e(){return g(-1)};var w=function e(){return g(1)};var b=function e(n){var t=x.index+n;return t>=0&&t<x.entries.length};var _=function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return s.setPrompt(n)};var O=function e(n){return s.appendListener(n)};var x={length:h.length,action:"POP",location:h[v],index:v,entries:h,createHref:d,push:p,replace:y,go:g,goBack:m,goForward:w,canGo:b,block:_,listen:O};return x};var me={BROWSER:"BROWSER",MEMORY:"MEMORY",HASH:"HASH"};var we=function(e,n,t){if(e==null){return}var r=-1,i=e.length;while(++r<i){if(n.call(t,e[r],r,e)===false){break}}};var be=function e(n){if(n===void 0)n=me.BROWSER;switch(n){case me.BROWSER:this._history=ae();break;case me.MEMORY:this._history=ge();break;case me.HASH:this._history=he();break;default:break}this._routes=[];this._unlistener=null;this._onBefore=null;this._onBeforeOnce=null;this._onAfter=null;this._onAfterOnce=null};be.prototype.start=function e(n){var t=this;if(n===void 0)n=true;this._unlistener=this._history.listen(function(e,n){t._change(e,n)});if(n){this._change(this.getCurrentLocation(),this.getCurrentAction())}};be.prototype.stop=function e(){if(!this._unlistener){return}this._unlistener();this._unlistener=null};be.prototype.on=function e(n,r,i,o){var a=[];var f=t(n,a);this._routes.push({pattern:n,regexp:f,keys:a,onEnter:r,onBefore:i,onAfter:o});return this};be.prototype.onBefore=function e(n){this._onBefore=n;return this};be.prototype.onBeforeOnce=function e(n){this._onBeforeOnce=n;return this};be.prototype.onAfter=function e(n){this._onAfter=n;return this};be.prototype.onAfterOnce=function e(n){this._onAfterOnce=n;return this};be.prototype.navigateTo=function e(n,t){var r=this;if(t===void 0)t=false;return A.resolve().then(function(){if(!t&&r.getCurrentLocation().pathname===n){console.warn("same path is passed.");return}r._history.push(n)})};be.prototype.replace=function e(n){var t=this;return A.resolve().then(function(){if(t.getCurrentLocation().pathname===n){console.warn("same path is passed.");return}t._history.replace(n)})};be.prototype.getCurrentLocation=function e(){return this._history.location};be.prototype.getCurrentAction=function e(){return this._history.action};be.prototype.createHref=function e(n){return this._history.createHref({pathname:n})};be.prototype._change=function e(n){var t=this;var r;we(this._routes,function(e){if(!!r){return}if(!!e.regexp.exec(n.pathname)){r=e}});if(!r){return}var i=this._parseLocation(n,r);var o=false;var a=function(e){o=true;t.replace(e)};A.resolve().then(function(){if(!t._onBeforeOnce){return A.resolve()}var e=t._onBeforeOnce;t._onBeforeOnce=null;return e(i)}).then(function(){if(!t._onBefore){return A.resolve()}return t._onBefore(i)}).then(function(){if(!r.onBefore){return A.resolve()}return r.onBefore(i,a)}).then(function(){if(o||!r.onEnter){return A.resolve()}return r.onEnter(i)}).then(function(){if(o||!r.onAfter){return A.resolve()}return r.onAfter(i)}).then(function(){if(o||!t._onAfter){return A.resolve()}return t._onAfter(i)}).then(function(){if(o||!t._onAfterOnce){return A.resolve()}var e=t._onAfterOnce;t._onAfterOnce=null;return e(i)}).catch(function(e){console.error(e.message||"couldn't route. check the onBefore and onAfter functions.")})};be.prototype._parseLocation=function e(n,t){var r={};var i=t.regexp.exec(n.pathname).slice(1);we(t.keys,function(e,n){r[e.name]=i[n]});var o={};we(n.search.slice(1).split("&"),function(e){if(!e){return}var n=e.split("=");o[n[0]]=n[1]});var a=n.hash.slice(1);return{params:r,queries:o,hash:a,pathname:n.pathname}};be.BROWSER=me.BROWSER;be.MEMORY=me.MEMORY;be.HASH=me.HASH;return be}();